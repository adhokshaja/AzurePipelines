parameters:
- name: extensionRoot
  type: string
- name: taskName
  type: string

steps:  
- task: qetza.replacetokens.replacetokens-task.replacetokens@3
  displayName: 'Replace tokens in **\\task.json for ${{taskName}}'
  inputs:
    rootDirectory: '${{extensionRoot}}\\${{taskName}}'
    targetFiles: '**\\task.json'

- task: Npm@0
  displayName: 'npm install for ${{taskName}}'
  inputs:
    cwd: '${{extensionRoot}}\\${{taskName}}'
- task: Npm@0
  displayName: 'npm run build for ${{taskName}}'
  inputs:
    cwd: '${{extensionRoot}}\\${{taskName}}'
    command: run
    arguments: build
- task: Npm@0
  displayName: 'npm run test for ${{taskName}}'
  inputs:
    cwd: '${{extensionRoot}}\\${{taskName}}'
    command: run
    arguments: test
- task: PublishTestResults@2
  displayName: 'Publish Test Results for ${{taskName}}'
  inputs:
    testResultsFiles: '${{extensionRoot}}\\${{taskName}}\test-output\test-results.xml'
    testRunTitle: '${{taskName}}'
- task: Npm@0
  displayName: 'npm run package for ${{taskName}}'
  inputs:
    cwd: '${{extensionRoot}}\\${{taskName}}'
    command: run
    arguments: package
 